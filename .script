#!/bin/sh

# Function to display usage
usage() {
  echo "Usage: $0 [playlist|video] [URL]"
  echo "  playlist    Download a YouTube playlist"
  echo "  video       Download a single YouTube video"
  exit 1
}

# Check if two arguments are provided
if [ "$#" -ne 2 ]; then
  usage
fi

# Get the type of download and URL from command-line arguments
DOWNLOAD_TYPE=$1
DOWNLOAD_URL=$2

# Switch based on the download type
case $DOWNLOAD_TYPE in
  playlist)
    # Navigate to playlist downloader directory
    cd playlist_downloader

    # Run Docker Compose with the playlist URL environment variable
    PLAYLIST_URL="$DOWNLOAD_URL" docker-compose up --build --force-recreate
    ;;
  
  video)
    # Navigate to video downloader directory
    cd video_downloader

    # Run Docker Compose with the video URL environment variable
    VIDEO_URL="$DOWNLOAD_URL" docker-compose up --build --force-recreate
    ;;
  
  *)
    usage
    ;;
esac

# Reset ownership of the downloads directory
sudo chown -R "$(whoami):$(id -gn $USER)" ../downloads
